---
title: "[论文解读]Building Natural Language Interfaces to Web APIs"
author: lornd
mathjax: true
date: 2023-07-17 17:56:41
url: NL2API
tags:
---

论文地址：[Building Natural Language Interfaces to Web APIs](https://readpaper.com/paper/2745934983) 。

## 摘要

随着 Web 面向服务架构的发展，应用程序接口（application program interfaces，APIs）正在变成提供对数据、服务和设备的访问越来越重要的方法。我们研究自然语言转换成 API （NL2APIs）问题，并且关注 Web 服务的 Web API。这些 NL2APIs 问题有很多潜在的好处，例如促进将 Web 服务集成到虚拟助手中。

对于一个给定的 Web API ，我们提出了第一个端到端的框架，以建立一个 NL2API 模型。一个关键的挑战在于收集训练数据，即（自然语言命令，API调用）对。从这些数据中，NL2API 模型可以学习到从非结构化的自然语言命令到结构化的 API 调用的映射。通过众包，我们提出了一个理想的为 NL2API 收集训练数据的方法。在众包的过程中，众包工作者们被用来生成各种各样的自然语言命令。为了进一步降低成本，我们还优化了众包工作的流程。更具体地，对于众包工作流程，我们提出了一个理想的分层概率模型，用于指导我们为对于训练 NL2API 模型有高价值的 API 调用分配更多的资源。我们将我们的框架应用在真实世界的 API 上，表明这个框架可以以低成本收集高质量的训练数据，并且从零开始训练出一个具有良好性能的 NL2API 模型。我们同时验证了：我们对众包过程的建模可以提高其效率，这使得通过我们的方法收集到的数据训练出了比一个强 baseline 更好的 NL2API 模型。

## 研究背景

受益于一系列原因，如面向服务的架构（service-oriented architecture, SOA），云计算和物联网（IoT），应用程序接口（APIs）正在虚拟世界和物理世界中发挥着越来越重要的作用。一般来说，API 被用于各种各样的软件，如桌面应用、网站、移动 app 等，这些软件通过图形化用户界面（graphical user interfaces， GUI）为用户提供服务。但是，随着计算领域的发展，有两个问题逐渐显现：

1. 随着计算设备变得更小，更可移动，更智能，需要屏幕变成了一个负担。
2. 为了使用不同的服务和设备，用户必须适应这些服务和设备提供的不同的 GUI ，这增加了用户的学习成本。

这个时候，类似于苹果的 Siri 以及微软的 Cortana 的自然语言界面（Natural language interface, NLI）就成为了一种可能的替代方式。

与以虚拟助手为代表的通用目标 NLI 不同，本文研究的时如何为单独的 Web API 建立 NLI。但是，让虚拟助手逐个集成 Web 服务是非常繁琐的。如果存在一个低成本的方式，能够为 API 建立对应 NLI，集成成本将会极大地下降。在这种情况下，虚拟助手不再需要处理不同的 Web 服务之间不同的界面，而只需要集成单独的 NL2API 。除此之外，NL2API 也可以促进 Web 服务发现、推荐，并且通过降低可用 Web API 及其语法的记忆成本，帮助 API 编程。

对于现阶段的 NLI 研究与应用来说，最关键的挑战是训练数据的收集。由于自然语言的灵活性，用户可以用各种各样的自然语言方式描述一个 API 的调用（如 "Where is the upcoming meeting?" 和 "Find next meeting's location."）。为了学习到这些语言的多样性吗，收集足够多的数据是必要的。已有的研究通常会通过 best-effort 行为收集训练数据，但是如果一个 API 没有被覆盖，或者被覆盖得不够多，就没办法补救；同时，用这种方法收集到的训练数据难以支持多参数的高级命令。因此，为了完全训练 API 的参数化，支持高级 NL 命令，对于一个给定的 API ，如何用活跃的，可定制的方式收集训练数据仍然是一个问题。

## 文章贡献

本文提出了第一个用于从零开始为 Web API 构建 NLI 的端到端的框架。具体包括如下三步：

1. **表示**：Web API 的原始 http 形式包含了很多不相关的，会分散注意力的信息。因此本文提出了Web API 的中间语义表示，以让 NLI 不会受无关细节的干扰。
2. **训练数据收集**：本文提出了一个理想的通过众包收集监督学习训练数据的方法。
3. **NL2API**：本文提出了两个 NL2API 模型，一个是基于检索模型的语言模型，另一个是序列到序列（seq2seq）的神经网络模型。

通过众包工作为 NL2API 收集训练数据的理想方法是本文的一个关键贡献，这个步骤有三个目标：

1. **可定制**：一个人应当确定什么 API、哪些参数、多少训练数据他想要收集。
2. **低成本**：众包工作者的成本比领域专家的成本低很多。
3. **高质量**：训练数据的质量也不能妥协。

通过众包工作的方法有两个主要的挑战：

1. **对于大多数用户来说，拥有高级参数的 API 调用难以理解，需要简化众包工作过程**。因此本文设计了一个 Web API 的中间语义表示，同时设计了一个语法将 API 调用转换为规范的 NL 命令。这样众包工作者就只需要以更自然的方式解释规范命令，从而训练数据收集过程会更少出错。
2. **如何识别并只解释对 NL2API 训练有高价值的 API**？本文为众包过程提出了一个独特的分层概率模型。本文假设 NL 命令是通过对应的 API 调用生成的，并对每一个 API 评估了一个语言模型用于捕捉生成过程。这个模型的基础在于 API 是可以组合的（"unread emails about PhD application" = "unread emails" + "emails about PhD applicationz"）。这样，通过解释一小部分 API 调用，就可以得到能解释所有 API 调用的模型。尽管这个模型并不完美，然而，通过预测未解释 API 调用的语言模型，本文提供了一个所有 API 调用和自然语言与 API 调用的相互关系的整体视角，这让我们有可能优化众包过程。

最后，本文将这个框架用于 Microsoft API 套件中两个已部署的 API 上。展示了通过本文的方法，可以低成本地收集高质量的训练数据。同时众包过程也变得更加高效。在相同的预算下，相较于一个强的 baseline ，可以收集到更好的训练数据，这也让 NL2API 的准确率更高。

## 问题描述（设定）

近年来，REST 架构的 API，即 RESTful API 由于其简便性，变得越来越流行。本文的工作主要聚焦于 RESTful API。对于 RESTful API，采用流行的开放数据协议（Open Data Protoco, OData）。在 OData 中，资源是**实体**，每个实体具有一系列**属性**。除此之外，OData 定义了一个**请求选项集合**以支持高级资源操作。在本文中，定义 http 动作和实体或实体集合的组合为 **API**（如电子邮件研究中的 `GET-Messages`），每个参数化的请求选项（如 `FILTER(isRead=False)`）被称为**参数**；一个 **API 调用**就是有一系列参数的 API 。

NLI 的核心任务是将自然语言命令映射成一些正式的意义表示，如 Web API。为了更好地专注于语义映射，排除一些无关的细节，中间语义表示是一个常用的技巧，而不是直接处理目标表示。本文为 RESTful API 定义了一个中间表示，称之为 API 框架，并与之与框架语义联系起来。一个 API 框架包括五个部分：

- **http 动作**和**资源**：这是 RESTful API 的基本元素。
- **返回类型**：这在 API 组合的情况下非常有用，即将多个 API 组合起来使用，以完成更复杂的任务。
- **必需参数**：经常被用在 `PUT` 请求和 `POST` 请求中。
- **可选参数**：经常用于 `GET` 请求以指定需要的细节信息。

当没有必需参数时，序列化 API 框架（如 `GET-messages{FILTER(isRead=False), SEARCH("PhD application"), COUNT()}`）。一个 API 框架可以被唯一地转换为一个真实的 API 调用。必要的上下文信息如用户 ID、位置和日期时间会在会话的过程中被填充。

有了这些定义，在本文的后半部分，API 框架和 API 调用表示的意义是相同的。

## 解决方法

本文首先生成 API 调用并且通过一个简单的语法将其转换为规范的命令，之后雇佣众包工作者解释这些规范命令。基于 API 调用的组合特性，本文为众包过程提出了一个分层概率模型，同时提出了一个算法以优化众包过程。最后，为了验证提出的框架，本文使用其他 API 领域内两个成功的模型进行了测试。

### API 调用与规范命令

### 语义网格

### 众包工作优化

### 模型测试

#### 基于 LM 的检索模型

#### seq2seq 解释模型

## 实验验证